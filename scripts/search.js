const b={ANIMATION:{DEBOUNCE:150}},p={currentValue:"",wasCleared:!1},l={searchBar:document.getElementById("search-bar"),fixedSearchBar:document.getElementById("fixedSearchBar"),clearButton:document.getElementById("clearSearch"),clearButtonFixed:document.getElementById("clearFixedSearch"),searchButton:document.getElementById("searchButton"),container:document.getElementById("plugins-container")||document.getElementById("plugins-list"),featuredPluginContainer:document.getElementById("featured-plugin-container")};function E(e,t){let n;return(...a)=>(clearTimeout(n),new Promise(c=>{n=setTimeout(()=>c(e(...a)),t)}))}function f(e){return e?e.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function x(e){var c,u,o;const t=l.container.id==="plugins-list",n=Array.from(l.container.getElementsByClassName(t?"admin-plugin-item":"plugin-card")),a=f(e);if(!a){for(const i of n)i.style.display=t?"block":"flex";B("",n),t||(c=window.renderPlugins)==null||c.call(window);return}if(t){let i=0;for(const s of n){const r=f((u=s.querySelector(".plugin-info span:nth-child(2)"))==null?void 0:u.textContent),m=(o=s.querySelector(".warning-message"))==null?void 0:o.value,h=(r==null?void 0:r.includes(a))||m&&f(m).includes(a);s.style.display=h?"block":"none",h&&i++}B(e,i)}else{const i=n.map(s=>{const r=f(s.querySelector(".plugin-name").textContent),m=f(s.querySelector(".plugin-description").textContent),h=f(s.querySelector(".plugin-author").textContent);let d=0;return r.includes(a)&&(d+=100),h.includes(a)&&(d+=50),m.includes(a)&&(d+=25),r.startsWith(a)&&(d+=50),{card:s,score:d,hasMatch:d>0}});i.sort((s,r)=>r.score-s.score);for(const{card:s,hasMatch:r}of i)s.style.display=r?"flex":"none",r&&l.container.appendChild(s);B(e,i.filter(s=>s.hasMatch).map(s=>s.card))}}function B(e,t){const n=document.getElementById("searchSubtext");if(!n)return;if(!e){n.textContent="",n.classList.remove("visible");return}const a=typeof t=="number"?t:t.filter(u=>u.style.display!=="none").length,c=`Found ${a} matching plugin${a===1?"":"s"}`;n.textContent=c,n.classList.add("visible")}function S(e){if(l.featuredPluginContainer){const t=l.featuredPluginContainer.querySelector(".featured-plugin-card");t&&e&&e.trim()!==""&&t.classList.contains("expanded")&&t.classList.remove("expanded")}}function C(){const{searchBar:e,fixedSearchBar:t,clearButton:n,clearButtonFixed:a}=l,c=o=>{const i=o.target.value;p.currentValue=i,p.wasCleared=!1,I(i),y(o.target,i);const s=o.target===e?t:e;s.value=i,y(s,i),S(i)};for(const o of[e,t])o&&o.addEventListener("input",c);const u=o=>{p.currentValue="",p.wasCleared=!0;for(const i of[e,t])i.value="",y(i,"");x(""),S(""),o.focus()};for(const{button:o,input:i}of[{button:n,input:e},{button:a,input:t}])o&&o.addEventListener("click",()=>u(i))}function y(e,t){const n=l[e.id==="search-bar"?"clearButton":"clearButtonFixed"];if(!n)return;const a=t.length>0&&(e.id!=="fixedSearchBar"||e.classList.contains("show"));n.style.display=a?"block":"none"}function v(){const{searchButton:e,fixedSearchBar:t,clearButtonFixed:n}=l;e==null||e.addEventListener("click",()=>{const a=t.classList.contains("hidden");t.classList.toggle("hidden",!a),t.classList.toggle("show",a),a?(t.focus(),n.style.display=t.value.length>0?"block":"none"):n.style.display="none"})}const g=document.getElementById("fixedSearchBar");g&&(g.addEventListener("focus",()=>{g.dataset.isFocused="true"}),g.addEventListener("blur",()=>{g.dataset.isFocused="false"}));export const isFixedSearchFocused=()=>{var e;return((e=document.getElementById("fixedSearchBar"))==null?void 0:e.dataset.isFocused)==="true"};const I=E(x,b.ANIMATION.DEBOUNCE);document.addEventListener("DOMContentLoaded",()=>{C(),v()});
