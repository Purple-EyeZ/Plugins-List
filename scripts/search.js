const S={ANIMATION:{DEBOUNCE:150}},g={currentValue:"",wasCleared:!1},u={searchBar:document.getElementById("search-bar"),fixedSearchBar:document.getElementById("fixedSearchBar"),clearButton:document.getElementById("clearSearch"),clearButtonFixed:document.getElementById("clearFixedSearch"),searchButton:document.getElementById("searchButton"),container:document.getElementById("plugins-container")||document.getElementById("plugins-list")};function x(t,n){let c;return(...a)=>(clearTimeout(c),new Promise(i=>{c=setTimeout(()=>i(t(...a)),n)}))}function d(t){return t?t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function y(t){var i;const n=u.container.id==="plugins-list",c=Array.from(u.container.getElementsByClassName(n?"admin-plugin-item":"plugin-card")),a=d(t);if(!a){c.forEach(o=>{o.style.display=n?"block":"flex"}),m("",c),n||(i=window.renderPlugins)==null||i.call(window);return}if(n){let o=0;c.forEach(e=>{var r,p;const s=d((r=e.querySelector(".plugin-info span:nth-child(2)"))==null?void 0:r.textContent),l=(p=e.querySelector(".warning-message"))==null?void 0:p.value,h=(s==null?void 0:s.includes(a))||l&&d(l).includes(a);e.style.display=h?"block":"none",h&&o++}),m(t,o)}else{const o=c.map(e=>{const s=d(e.querySelector(".plugin-name").textContent),l=d(e.querySelector(".plugin-description").textContent),h=d(e.querySelector(".plugin-author").textContent);let r=0;return s.includes(a)&&(r+=100),h.includes(a)&&(r+=50),l.includes(a)&&(r+=25),s.startsWith(a)&&(r+=50),{card:e,score:r,hasMatch:r>0}});o.sort((e,s)=>s.score-e.score),o.forEach(({card:e,hasMatch:s})=>{e.style.display=s?"flex":"none",s&&u.container.appendChild(e)}),m(t,o.filter(e=>e.hasMatch).map(e=>e.card))}}function m(t,n){const c=document.getElementById("searchSubtext");if(!c)return;if(!t){c.textContent="",c.classList.remove("visible");return}const a=typeof n=="number"?n:n.filter(o=>o.style.display!=="none").length,i=`Found ${a} matching plugin${a===1?"":"s"}`;c.textContent=i,c.classList.add("visible")}function E(){const{searchBar:t,fixedSearchBar:n,clearButton:c,clearButtonFixed:a}=u,i=e=>{const s=e.target.value;g.currentValue=s,g.wasCleared=!1,C(s),B(e.target,s);const l=e.target===t?n:t;l.value=s,B(l,s)};[t,n].forEach(e=>{e&&e.addEventListener("input",i)});const o=e=>{g.currentValue="",g.wasCleared=!0,[t,n].forEach(s=>{s.value="",B(s,"")}),y(""),e.focus()};[{button:c,input:t},{button:a,input:n}].forEach(({button:e,input:s})=>{e&&e.addEventListener("click",()=>o(s))})}function B(t,n){const c=u[t.id==="search-bar"?"clearButton":"clearButtonFixed"];if(!c)return;const a=n.length>0&&(t.id!=="fixedSearchBar"||t.classList.contains("show"));c.style.display=a?"block":"none"}function v(){const{searchButton:t,fixedSearchBar:n,clearButtonFixed:c}=u;t==null||t.addEventListener("click",()=>{const a=n.classList.contains("hidden");n.classList.toggle("hidden",!a),n.classList.toggle("show",a),a?(n.focus(),c.style.display=n.value.length>0?"block":"none"):c.style.display="none"})}const f=document.getElementById("fixedSearchBar");f&&(f.addEventListener("focus",()=>{f.dataset.isFocused="true"}),f.addEventListener("blur",()=>{f.dataset.isFocused="false"}));export const isFixedSearchFocused=()=>{var t;return((t=document.getElementById("fixedSearchBar"))==null?void 0:t.dataset.isFocused)==="true"};const C=x(y,S.ANIMATION.DEBOUNCE);document.addEventListener("DOMContentLoaded",()=>{E(),v()});
