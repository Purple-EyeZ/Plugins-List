const x={ANIMATION:{DEBOUNCE:150}},B={currentValue:"",wasCleared:!1},d={searchBar:document.getElementById("search-bar"),fixedSearchBar:document.getElementById("fixedSearchBar"),clearButton:document.getElementById("clearSearch"),clearButtonFixed:document.getElementById("clearFixedSearch"),searchButton:document.getElementById("searchButton"),container:document.getElementById("plugins-container")||document.getElementById("plugins-list")};function b(e,t){let n;return(...s)=>(clearTimeout(n),new Promise(i=>{n=setTimeout(()=>i(e(...s)),t)}))}function f(e){return e?e.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function S(e){var i,l,a;const t=d.container.id==="plugins-list",n=Array.from(d.container.getElementsByClassName(t?"admin-plugin-item":"plugin-card")),s=f(e);if(!s){for(const c of n)c.style.display=t?"block":"flex";p("",n),t||(i=window.renderPlugins)==null||i.call(window);return}if(t){let c=0;for(const o of n){const r=f((l=o.querySelector(".plugin-info span:nth-child(2)"))==null?void 0:l.textContent),m=(a=o.querySelector(".warning-message"))==null?void 0:a.value,g=(r==null?void 0:r.includes(s))||m&&f(m).includes(s);o.style.display=g?"block":"none",g&&c++}p(e,c)}else{const c=n.map(o=>{const r=f(o.querySelector(".plugin-name").textContent),m=f(o.querySelector(".plugin-description").textContent),g=f(o.querySelector(".plugin-author").textContent);let u=0;return r.includes(s)&&(u+=100),g.includes(s)&&(u+=50),m.includes(s)&&(u+=25),r.startsWith(s)&&(u+=50),{card:o,score:u,hasMatch:u>0}});c.sort((o,r)=>r.score-o.score);for(const{card:o,hasMatch:r}of c)o.style.display=r?"flex":"none",r&&d.container.appendChild(o);p(e,c.filter(o=>o.hasMatch).map(o=>o.card))}}function p(e,t){const n=document.getElementById("searchSubtext");if(!n)return;if(!e){n.textContent="",n.classList.remove("visible");return}const s=typeof t=="number"?t:t.filter(l=>l.style.display!=="none").length,i=`Found ${s} matching plugin${s===1?"":"s"}`;n.textContent=i,n.classList.add("visible")}function E(){const{searchBar:e,fixedSearchBar:t,clearButton:n,clearButtonFixed:s}=d,i=a=>{const c=a.target.value;B.currentValue=c,B.wasCleared=!1,C(c),y(a.target,c);const o=a.target===e?t:e;o.value=c,y(o,c)};for(const a of[e,t])a&&a.addEventListener("input",i);const l=a=>{B.currentValue="",B.wasCleared=!0;for(const c of[e,t])c.value="",y(c,"");S(""),a.focus()};for(const{button:a,input:c}of[{button:n,input:e},{button:s,input:t}])a&&a.addEventListener("click",()=>l(c))}function y(e,t){const n=d[e.id==="search-bar"?"clearButton":"clearButtonFixed"];if(!n)return;const s=t.length>0&&(e.id!=="fixedSearchBar"||e.classList.contains("show"));n.style.display=s?"block":"none"}function v(){const{searchButton:e,fixedSearchBar:t,clearButtonFixed:n}=d;e==null||e.addEventListener("click",()=>{const s=t.classList.contains("hidden");t.classList.toggle("hidden",!s),t.classList.toggle("show",s),s?(t.focus(),n.style.display=t.value.length>0?"block":"none"):n.style.display="none"})}const h=document.getElementById("fixedSearchBar");h&&(h.addEventListener("focus",()=>{h.dataset.isFocused="true"}),h.addEventListener("blur",()=>{h.dataset.isFocused="false"}));export const isFixedSearchFocused=()=>{var e;return((e=document.getElementById("fixedSearchBar"))==null?void 0:e.dataset.isFocused)==="true"};const C=b(S,x.ANIMATION.DEBOUNCE);document.addEventListener("DOMContentLoaded",()=>{E(),v()});
