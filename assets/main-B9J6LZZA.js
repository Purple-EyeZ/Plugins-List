import{s as k,h as m,a as f,i as S,p as w,f as C,b as P,c as x}from"./snow-D7OAaGRj.js";function y(e){navigator.clipboard.writeText(e).catch(t=>{console.error("Failed to copy: ",t)})}function p(e){switch(e){case"working":return"âœ…";case"warning":return"âš ï¸";case"broken":return"âŒ";default:return""}}function v(e){const t=document.getElementById("featured-plugin-template");if(!t)return null;const n=t.content.cloneNode(!0).querySelector(".featured-plugin-card");return n?(n.querySelector(".featured-plugin-name").textContent=e.name,n.querySelector(".featured-plugin-author").textContent=`By: ${e.authors.join(", ")}`,n.querySelector(".featured-plugin-description").textContent=e.description,n.querySelector(".featured-copy-button").addEventListener("click",i=>{i.stopPropagation(),y(e.installUrl),f(`Link for ${e.name} copied to clipboard!`)}),n.addEventListener("click",()=>{n.classList.toggle("expanded")}),n):null}function B(e){const t=document.getElementById("plugin-card-template");if(!t)return null;const a=t.content.cloneNode(!0).querySelector(".plugin-card"),n={working:"status-badge--working",warning:"status-badge--warning",broken:"status-badge--broken"};a.querySelector(".plugin-name").textContent=e.name,a.querySelector(".plugin-author").textContent=`By: ${e.authors.join(", ")}`,a.querySelector(".plugin-description").textContent=e.description;const o=a.querySelector(".status-badge");return o.textContent=e.status,o.className="status-badge",n[e.status]&&o.classList.add(n[e.status]),a.querySelector(".source-button").addEventListener("click",()=>{window.open(e.sourceUrl,"_blank")}),a.querySelector(".plugin-copy-button").addEventListener("click",()=>{if(e.status==="working")y(e.installUrl),f(`Link for ${e.name} copied to clipboard!`);else{const i=e.status==="broken"?"Installing broken plugins may crash your client or cause unexpected behavior.":"This plugin may not work as expected.";k({title:"Warning!",message:i,infoBox:e.warningMessage||"",primaryButton:{text:"Copy Anyway",action:()=>{y(e.installUrl),f(`Link for ${e.name} copied to clipboard!`),m()}},secondaryButton:{text:"Cancel",action:()=>m()}})}}),a}function E(e,t,a,n){e.innerHTML="";const o=n?[...t]:t.filter(r=>r.status!=="broken");switch(a){case"default":o.sort((r,s)=>r.status==="broken"&&s.status!=="broken"?1:r.status!=="broken"&&s.status==="broken"?-1:r.name.localeCompare(s.name));break;case"broken-first":o.sort((r,s)=>r.status==="broken"&&s.status!=="broken"?-1:r.status!=="broken"&&s.status==="broken"?1:r.name.localeCompare(s.name));break;case"alphabetical":o.sort((r,s)=>r.name.localeCompare(s.name));break}const i=[];for(const r of o){const s=B(r);i.push(s),e.appendChild(s)}return{renderedPlugins:o,renderedElements:i}}function L(e,t){if(e&&(e.innerHTML="",t)){const a=v(t);a&&e.appendChild(a)}}function $(e){if(!e||e.updated.length===0&&e.added.length===0)return;let t="",a=!0;e.updated.length>0&&(t+='<h4 style="margin-top: 0px; margin-bottom: 5px;">ðŸ”ƒ Status changes:</h4>',t+=e.updated.map(n=>`${n.name}: ${p(n.oldStatus)} ${n.oldStatus} â†’ ${p(n.newStatus)} ${n.newStatus}`).join("<br>"),a=!1),e.added.length>0&&(t+=`<h4 ${a?'style="margin-top: 0px; margin-bottom: 5px;"':'style="margin-top: 25px; margin-bottom: 5px;"'}>ðŸš€ Added:</h4>`,t+=e.added.map(o=>`${o.name} (${p(o.status)} ${o.status})`).join("<br>")),k({title:"Plugin Changes Detected",message:"Here is a summary of plugin changes since your last visit:",infoBox:t,primaryButton:{text:"Got it!",action:()=>m()},secondaryButton:null})}let u=[],h="default",b=!0;const l=document.getElementById("plugins-container"),q=document.getElementById("featured-plugin-container"),c=document.getElementById("sort-select"),d=document.getElementById("show-broken");function T(e){const t=localStorage.getItem("previousPluginsState"),a=JSON.stringify(e);if(localStorage.setItem("previousPluginsState",a),!t)return null;const n=JSON.parse(t),o=new Map(n.map(r=>[r.name,r])),i={updated:[],added:[]};for(const r of e){const s=o.get(r.name);s?s.status!==r.status&&i.updated.push({name:r.name,oldStatus:s.status,newStatus:r.status}):i.added.push(r)}return i}function g(){if(!l)return;S();const{renderedPlugins:e,renderedElements:t}=E(l,u,h,b);w(e,t),C(P.currentValue)}async function I(){h=c?c.value:"default",b=d?d.checked:!0;try{const e=await fetch("/plugins-data.json");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);u=await e.json();const t=u.find(n=>n.name==="Plugins List");L(q,t);const a=T(u);$(a),g(),x()}catch(e){console.error("Error loading plugins data:",e),l&&(l.innerHTML='<div class="error-message">Failed to load plugins. Please try again later.</div>')}}function F(){c&&c.addEventListener("change",e=>{h=e.target.value,g()}),d&&d.addEventListener("change",e=>{b=e.target.checked,g()})}window.renderPlugins=g;I();F();
