import{s as S,h as f,a as y,i as w}from"./snow-CeWGaY71.js";function h(e){navigator.clipboard.writeText(e).catch(t=>{console.error("Failed to copy: ",t)})}function m(e){switch(e){case"working":return"âœ…";case"warning":return"âš ï¸";case"broken":return"âŒ";default:return""}}function C(e){const t=document.getElementById("featured-plugin-template");if(!t)return null;const n=t.content.cloneNode(!0).querySelector(".featured-plugin-card");return n?(n.querySelector(".featured-plugin-name").textContent=e.name,n.querySelector(".featured-plugin-author").textContent=`By: ${e.authors.join(", ")}`,n.querySelector(".featured-plugin-description").textContent=e.description,n.querySelector(".featured-copy-button").addEventListener("click",i=>{i.stopPropagation(),h(e.installUrl),y(`Link for ${e.name} copied to clipboard!`)}),n.addEventListener("click",()=>{n.classList.toggle("expanded")}),n):null}function x(e){const t=document.getElementById("plugin-card-template");if(!t)return null;const r=t.content.cloneNode(!0).querySelector(".plugin-card"),n={working:"status-badge--working",warning:"status-badge--warning",broken:"status-badge--broken"};r.querySelector(".plugin-name").textContent=e.name,r.querySelector(".plugin-author").textContent=`By: ${e.authors.join(", ")}`,r.querySelector(".plugin-description").textContent=e.description;const o=r.querySelector(".status-badge");return o.textContent=e.status,o.className="status-badge",n[e.status]&&o.classList.add(n[e.status]),r.querySelector(".source-button").addEventListener("click",()=>{window.open(e.sourceUrl,"_blank")}),r.querySelector(".plugin-copy-button").addEventListener("click",()=>{if(e.status==="working")h(e.installUrl),y(`Link for ${e.name} copied to clipboard!`);else{const i=e.status==="broken"?"Installing broken plugins may crash your client or cause unexpected behavior.":"This plugin may not work as expected.";S({title:"Warning!",message:i,infoBox:e.warningMessage||"",primaryButton:{text:"Copy Anyway",action:()=>{h(e.installUrl),y(`Link for ${e.name} copied to clipboard!`),f()}},secondaryButton:{text:"Cancel",action:()=>f()}})}}),r}function P(e,t,r,n){e.innerHTML="";const o=n?[...t]:t.filter(a=>a.status!=="broken");switch(r){case"default":o.sort((a,s)=>a.status==="broken"&&s.status!=="broken"?1:a.status!=="broken"&&s.status==="broken"?-1:a.name.localeCompare(s.name));break;case"broken-first":o.sort((a,s)=>a.status==="broken"&&s.status!=="broken"?-1:a.status!=="broken"&&s.status==="broken"?1:a.name.localeCompare(s.name));break;case"alphabetical":o.sort((a,s)=>a.name.localeCompare(s.name));break}const i=[];for(const a of o){const s=x(a);i.push(s),e.appendChild(s)}return{renderedPlugins:o,renderedElements:i}}function v(e,t){if(e&&(e.innerHTML="",t)){const r=C(t);r&&e.appendChild(r)}}function B(e){if(!e||e.updated.length===0&&e.added.length===0)return;let t="",r=!0;e.updated.length>0&&(t+='<h4 style="margin-top: 0px; margin-bottom: 5px;">ðŸ”ƒ Status changes:</h4>',t+=e.updated.map(n=>`${n.name}: ${m(n.oldStatus)} ${n.oldStatus} â†’ ${m(n.newStatus)} ${n.newStatus}`).join("<br>"),r=!1),e.added.length>0&&(t+=`<h4 ${r?'style="margin-top: 0px; margin-bottom: 5px;"':'style="margin-top: 25px; margin-bottom: 5px;"'}>ðŸš€ Added:</h4>`,t+=e.added.map(o=>`${o.name} (${m(o.status)} ${o.status})`).join("<br>")),S({title:"Plugin Changes Detected",message:"Here is a summary of plugin changes since your last visit:",infoBox:t,primaryButton:{text:"Got it!",action:()=>f()},secondaryButton:null})}let l=[],b="default",k=!0;const d=document.getElementById("plugins-container"),E=document.getElementById("featured-plugin-container"),g=document.getElementById("sort-select"),p=document.getElementById("show-broken"),c=w({containerId:"plugins-container",itemClass:"plugin-card",searchKeys:["name","authors","description"],priorityKey:"name",subtextMessage:e=>`Found ${e} matching plugin${e===1?"":"s"}`,renderFunction:u,displayStyle:"flex"});function L(e){const t=localStorage.getItem("previousPluginsState"),r=JSON.stringify(e);if(localStorage.setItem("previousPluginsState",r),!t)return null;const n=JSON.parse(t),o=new Map(n.map(a=>[a.name,a])),i={updated:[],added:[]};for(const a of e){const s=o.get(a.name);s?s.status!==a.status&&i.updated.push({name:a.name,oldStatus:s.status,newStatus:a.status}):i.added.push(a)}return i}function u(e=!1){if(!d)return;const{renderedPlugins:t,renderedElements:r}=P(d,l,b,k);c.prepareSearchableData(t,r),e||c.filterItems(c.getCurrentValue())}async function $(){b=g?g.value:"default",k=p?p.checked:!0;try{const e=await fetch("/plugins-data.json");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);l=await e.json();const t=l.find(n=>n.name==="Plugins List");v(E,t);const r=L(l);B(r),u(),c.initSearchFromURL()}catch(e){console.error("Error loading plugins data:",e),d&&(d.innerHTML='<div class="error-message">Failed to load plugins. Please try again later.</div>')}}function q(){g&&g.addEventListener("change",e=>{b=e.target.value,u()}),p&&p.addEventListener("change",e=>{k=e.target.checked,u()})}window.renderPlugins=u;$();q();
